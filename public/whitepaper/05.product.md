# 产品架构

## 整体架构

轻养到家采用**三端分离**架构，分别服务不同角色：

```
┌─────────────────────────────────────────────────────────────┐
│                      轻养到家产品矩阵                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │
│   │   用户端    │  │   技师端    │  │   商户端    │       │
│   │  /user/     │  │  /tech/     │  │ /merchant/  │       │
│   ├─────────────┤  ├─────────────┤  ├─────────────┤       │
│   │ • 浏览服务  │  │ • 接单管理  │  │ • 订单管理  │       │
│   │ • 预约技师  │  │ • 收入查看  │  │ • 技师管理  │       │
│   │ • 订单管理  │  │ • 评价管理  │  │ • 借调管理  │       │
│   │ • 评价反馈  │  │ • 找工作    │  │ • 招聘发布  │       │
│   └─────────────┘  └─────────────┘  └─────────────┘       │
│           │                │                │              │
│           └────────────────┼────────────────┘              │
│                            ▼                               │
│                    ┌─────────────┐                        │
│                    │   管理后台   │                        │
│                    │   /admin/   │                        │
│                    ├─────────────┤                        │
│                    │ • 用户管理  │                        │
│                    │ • 订单监控  │                        │
│                    │ • 数据统计  │                        │
│                    │ • 系统配置  │                        │
│                    └─────────────┘                        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 用户端功能

### 核心流程

```
首页 ──► 选择服务/技师/店铺 ──► 预约时间 ──► 确认订单 ──► 支付 ──► 等待服务 ──► 评价
```

### 功能模块

| 模块 | 功能 | 优先级 |
|------|------|--------|
| 首页 | 服务推荐、技师推荐、附近店铺 | P0 |
| 服务列表 | 按类型筛选、价格排序 | P0 |
| 技师列表 | 评分筛选、距离排序、收藏 | P0 |
| 店铺列表 | 附近店铺、到店消费 | P1 |
| 订单管理 | 待支付、进行中、已完成、评价 | P0 |
| 个人中心 | 收藏、地址、优惠券、消息 | P1 |

### 页面清单

- `/user/home` - 首页
- `/user/service/list` - 服务列表
- `/user/technician/list` - 技师列表
- `/user/technician/detail/:id` - 技师详情
- `/user/shop/list` - 店铺列表
- `/user/shop/detail/:id` - 店铺详情
- `/user/order/create` - 创建订单
- `/user/order/list` - 订单列表
- `/user/order/detail/:id` - 订单详情
- `/user/order/review/:id` - 评价
- `/user/profile` - 个人中心

## 技师端功能

### 核心流程

```
登录 ──► 设置接单状态 ──► 收到订单 ──► 接单 ──► 前往服务 ──► 完成服务 ──► 收入到账
```

### 功能模块

| 模块 | 功能 | 优先级 |
|------|------|--------|
| 工作台 | 今日数据、待处理订单、快捷操作 | P0 |
| 订单管理 | 待接单、进行中、已完成 | P0 |
| 收入管理 | 收入明细、申请提现 | P0 |
| 接单设置 | 服务范围、工作时间、订单偏好 | P1 |
| 评价管理 | 查看评价、回复评价 | P1 |
| 找工作 | 浏览招聘、申请职位 | P2 |

### 页面清单

- `/tech/home` - 工作台
- `/tech/order/list` - 订单列表
- `/tech/order/detail/:id` - 订单详情
- `/tech/income` - 收入明细
- `/tech/income/withdraw` - 申请提现
- `/tech/setting/accept` - 接单设置
- `/tech/review/list` - 我的评价
- `/tech/job/list` - 店铺招聘
- `/tech/profile` - 个人中心
- `/tech/certification` - 认证申请

## 商户端功能

### 核心流程

```
登录 ──► 管理技师 ──► 接收订单 ──► 指派技师 ──► 跟踪服务 ──► 结算收入
```

### 功能模块

| 模块 | 功能 | 优先级 |
|------|------|--------|
| 工作台 | 今日数据、待处理事项、快捷操作 | P0 |
| 订单管理 | 新订单、进行中、已完成 | P0 |
| 技师管理 | 店内技师、添加技师、借调技师 | P0 |
| 服务管理 | 服务项目、价格设置 | P1 |
| 收入管理 | 收入明细、申请提现 | P1 |
| 招聘管理 | 发布招聘、查看申请 | P2 |

### 页面清单

- `/merchant/home` - 工作台
- `/merchant/order/list` - 订单列表
- `/merchant/order/detail/:id` - 订单详情
- `/merchant/tech/list` - 技师列表
- `/merchant/tech/add` - 添加技师
- `/merchant/tech/borrow` - 借调技师
- `/merchant/service/list` - 服务项目
- `/merchant/income` - 收入明细
- `/merchant/job/list` - 招聘管理
- `/merchant/profile` - 店铺信息

## 订单状态流转

```
┌─────────────────────────────────────────────────────────────┐
│                      订单状态流转图                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   待支付 ──► 待接单 ──► 已接单 ──► 服务中 ──► 已完成        │
│     │          │          │          │          │          │
│     ▼          ▼          ▼          ▼          ▼          │
│   已取消    已拒绝     已取消     异常      待评价          │
│                                      │          │          │
│                                      ▼          ▼          │
│                                   已退款     已评价         │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 数据模型

### 核心实体

| 实体 | 说明 | 关键字段 |
|------|------|---------|
| User | 用户 | phone, nickname, avatar |
| Technician | 技师 | type, merchant_id, status |
| Merchant | 商户 | name, address, contact |
| Service | 服务 | name, price, duration |
| Order | 订单 | type, status, amount |
| Review | 评价 | scores, content, reply |
