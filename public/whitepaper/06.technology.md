# 技术方案

## 技术栈


```mindmap
# 技术栈全景
## 前端技术
### Vue 3
- 前端框架
- 生态成熟、性能优秀
### Vite
- 构建工具
- 开发体验好、构建快
### TDesign
- UI 组件库
- 腾讯出品、移动端友好
### Vue Router
- 路由管理
- 官方方案、稳定可靠
### Pinia
- 状态管理
- Vue 3 推荐、轻量
## 后端技术
### PHP 8
- 后端语言
- 部署简单、生态丰富
### MySQL 8
- 数据库
- 稳定可靠、运维成熟
### Redis
- 缓存
- 高性能、支持多数据结构
### Nginx
- Web 服务器
- 高并发、反向代理
## 基础设施
### 阿里云 ECS
- 云服务器
- 弹性计算
### 阿里云 OSS
- 对象存储
- 图片、文件存储
### 阿里云 CDN
- 静态资源加速
### 阿里云 SMS
- 短信服务
- 验证码发送
### 微信/支付宝
- 在线支付
```

## 系统架构


```mindmap
# 系统架构
## 用户设备
### 用户端 H5/App
### 技师端 H5/App
### 商户端 H5/App
## CDN / 负载均衡
- 静态资源加速
- 流量分发
- DDoS 防护
## Nginx 层
### 静态资源
- /pages/* 页面
- 图片/CSS/JS
### API 代理
- /api/* 接口
- 反向代理
## PHP 应用层
### 用户 API
- 预约下单
- 评价反馈
### 技师 API
- 接单管理
- 收入查看
### 商户 API
- 订单管理
- 技师调度
## 数据层
### MySQL 主从
- 业务数据
- 读写分离
### Redis 缓存
- 会话管理
- 热点数据
### OSS 存储
- 图片文件
- 静态资源
```

## 目录结构

```
QuietYou/
├── src/                    # 前端源码
│   ├── views/              # 页面组件
│   │   ├── home/          # 官网
│   │   ├── user/          # 用户端
│   │   ├── tech/          # 技师端
│   │   ├── merchant/      # 商户端
│   │   └── admin/         # 管理后台
│   ├── components/        # 公共组件
│   ├── composables/       # 组合式函数
│   ├── router/            # 路由配置
│   └── styles/            # 全局样式
│
├── api/                    # PHP 后端
│   ├── user/              # 用户端 API
│   ├── tech/              # 技师端 API
│   ├── merchant/          # 商户端 API
│   └── admin/             # 管理后台 API
│
├── public/                 # 静态资源
├── pages/                  # 构建产物
├── sql/                    # 数据库脚本
└── docs/                   # 项目文档
```

## 数据库设计

### 核心表结构

| 表名 | 说明 | 主要字段 |
|------|------|---------|
| qy_user_list | 用户表 | phone, nickname, avatar |
| qy_technician_list | 技师表 | type, merchant_id, status |
| qy_merchant_list | 商户表 | name, address, contact |
| qy_service_list | 服务表 | name, price, duration |
| qy_order_list | 订单表 | type, status, amount |
| qy_review_list | 评价表 | scores, content |
| qy_borrow_list | 借调表 | from_merchant, to_merchant |

### 数据库规范

- 表名：`qy_` 前缀 + 业务名 + `_list`
- 主键：`id` 自增
- 时间：`created_at`, `updated_at`
- 软删除：`deleted_at`

## API 设计

### RESTful 规范

```
GET    /api/user/order/list      # 获取列表
GET    /api/user/order/detail:1  # 获取详情
POST   /api/user/order/create    # 创建
POST   /api/user/order/update    # 更新
POST   /api/user/order/delete    # 删除
```

### 响应格式

```json
{
  "code": 0,
  "message": "success",
  "data": {
    "list": [],
    "total": 100,
    "page": 1,
    "pageSize": 20
  }
}
```

## 安全措施

| 措施 | 说明 |
|------|------|
| HTTPS | 全站 HTTPS 加密 |
| JWT | 接口认证 |
| 参数校验 | 防止 SQL 注入、XSS |
| 限流 | 防止恶意请求 |
| 日志 | 操作日志、错误日志 |

## 部署方案

### 开发环境

```bash
npm run dev    # 启动前端开发服务器
./go.sh 0      # 启动本地开发环境
```

### 生产部署

```bash
./go.sh 1      # 完整部署（构建 + 同步 + 重启）
./go.sh 2      # 仅同步文件
```

### 服务器配置

| 配置 | 规格 |
|------|------|
| CPU | 2核 |
| 内存 | 4GB |
| 带宽 | 5Mbps |
| 系统 | CentOS 7 |
