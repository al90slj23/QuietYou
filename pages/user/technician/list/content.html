<div class="technician-list-page">
  <!-- 筛选栏 -->
  <div class="filter-bar">
    <div class="filter-item" id="filterGender" onclick="toggleFilter('gender')">
      <span>性别</span>
      <svg class="filter-arrow" width="12" height="12" viewBox="0 0 12 12">
        <path d="M3 4.5L6 7.5L9 4.5" stroke="currentColor" fill="none" stroke-width="1.5"/>
      </svg>
    </div>
    <div class="filter-item" id="filterRating" onclick="toggleFilter('rating')">
      <span>评分</span>
      <svg class="filter-arrow" width="12" height="12" viewBox="0 0 12 12">
        <path d="M3 4.5L6 7.5L9 4.5" stroke="currentColor" fill="none" stroke-width="1.5"/>
      </svg>
    </div>
    <div class="filter-item" id="filterDistance" onclick="toggleFilter('distance')">
      <span>距离</span>
      <svg class="filter-arrow" width="12" height="12" viewBox="0 0 12 12">
        <path d="M3 4.5L6 7.5L9 4.5" stroke="currentColor" fill="none" stroke-width="1.5"/>
      </svg>
    </div>
    <div class="filter-item" id="filterSort" onclick="toggleFilter('sort')">
      <span>综合排序</span>
      <svg class="filter-arrow" width="12" height="12" viewBox="0 0 12 12">
        <path d="M3 4.5L6 7.5L9 4.5" stroke="currentColor" fill="none" stroke-width="1.5"/>
      </svg>
    </div>
  </div>

  <!-- 筛选面板 -->
  <div class="filter-panel" id="filterPanel" style="display: none;">
    <div class="filter-panel-content" id="filterPanelContent">
      <!-- 动态内容 -->
    </div>
    <div class="filter-panel-mask" onclick="closeFilter()"></div>
  </div>

  <!-- 技师列表 -->
  <div class="technician-list" id="technicianList">
    <!-- 动态加载 -->
  </div>

  <!-- 空状态 -->
  <div class="empty-state" id="emptyState" style="display: none;">
    <div class="empty-icon"><t-icon name="search" size="48px" /></div>
    <div class="empty-text">暂无符合条件的技师</div>
    <button class="btn btn-secondary" onclick="resetFilters()">重置筛选</button>
  </div>
</div>

<style>
.technician-list-page {
  background: var(--bg-color);
  min-height: 100%;
}

/* Filter Bar */
.filter-bar {
  display: flex;
  background: var(--bg-white);
  border-bottom: 1px solid var(--border-color);
  position: sticky;
  top: 0;
  z-index: 10;
}

.filter-item {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 12px;
  font-size: 13px;
  color: var(--text-secondary);
  cursor: pointer;
  transition: color 0.2s;
}

.filter-item.active {
  color: var(--primary-color);
}

.filter-item.active .filter-arrow {
  transform: rotate(180deg);
}

.filter-arrow {
  margin-left: 4px;
  transition: transform 0.2s;
}

/* Filter Panel */
.filter-panel {
  position: fixed;
  top: calc(var(--header-height) + 44px);
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 50;
}

.filter-panel-content {
  background: var(--bg-white);
  padding: 16px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.filter-panel-mask {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.3);
  z-index: -1;
}

.filter-options {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}

.filter-option {
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 13px;
  color: var(--text-secondary);
  background: var(--bg-color);
  cursor: pointer;
  transition: all 0.2s;
}

.filter-option.active {
  color: var(--primary-color);
  background: var(--primary-light);
}

/* Technician List */
.technician-list {
  padding: 12px;
}

.technician-card {
  display: flex;
  background: var(--bg-white);
  border-radius: 8px;
  padding: 12px;
  margin-bottom: 12px;
  cursor: pointer;
  transition: transform 0.2s;
}

.technician-card:active {
  transform: scale(0.98);
}

.technician-avatar {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: linear-gradient(135deg, #e8f8ef 0%, #d1fae5 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 36px;
  flex-shrink: 0;
  position: relative;
}

.technician-status {
  position: absolute;
  bottom: 2px;
  right: 2px;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  border: 2px solid var(--bg-white);
}

.technician-status.online {
  background: var(--primary-color);
}

.technician-status.busy {
  background: var(--warning-color);
}

.technician-status.offline {
  background: var(--text-placeholder);
}

.technician-info {
  flex: 1;
  margin-left: 12px;
  display: flex;
  flex-direction: column;
}

.technician-header {
  display: flex;
  align-items: center;
  margin-bottom: 4px;
}

.technician-name {
  font-size: 16px;
  font-weight: 500;
  color: var(--text-primary);
  margin-right: 8px;
}

.technician-gender {
  font-size: 12px;
  padding: 1px 6px;
  border-radius: 2px;
  background: var(--bg-color);
}

.technician-gender.male {
  color: #3b82f6;
  background: #dbeafe;
}

.technician-gender.female {
  color: #ec4899;
  background: #fce7f3;
}

.technician-shop {
  font-size: 12px;
  color: var(--text-secondary);
  margin-bottom: 6px;
}

.technician-stats {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 6px;
}

.technician-rating {
  display: flex;
  align-items: center;
  font-size: 13px;
  color: var(--warning-color);
}

.technician-rating svg {
  margin-right: 2px;
}

.technician-orders {
  font-size: 12px;
  color: var(--text-placeholder);
}

.technician-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: auto;
}

.technician-distance {
  font-size: 12px;
  color: var(--text-placeholder);
}

.technician-distance svg {
  vertical-align: middle;
  margin-right: 2px;
}

.technician-price {
  font-size: 14px;
  color: var(--danger-color);
  font-weight: 500;
}

.technician-price::before {
  content: '¥';
  font-size: 11px;
}

.technician-price-suffix {
  font-size: 11px;
  font-weight: normal;
  color: var(--text-placeholder);
}

/* Empty State */
.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
}

.empty-icon {
  font-size: 48px;
  margin-bottom: 16px;
}

.empty-text {
  font-size: 14px;
  color: var(--text-placeholder);
  margin-bottom: 20px;
}
</style>


<script>
(function() {
  // Mock 数据 - 技师列表
  const allTechnicians = [
    { id: 1, name: '张师傅', gender: 1, avatar: '', shopName: '康乐养生馆', rating: 4.9, ratingCount: 156, orderCount: 328, distance: 1.2, price: 198, status: 1 },
    { id: 2, name: '李师傅', gender: 2, avatar: '', shopName: '悦享SPA会所', rating: 4.8, ratingCount: 98, orderCount: 256, distance: 2.5, price: 228, status: 1 },
    { id: 3, name: '王师傅', gender: 1, avatar: '', shopName: '康乐养生馆', rating: 4.9, ratingCount: 203, orderCount: 412, distance: 0.8, price: 268, status: 2 },
    { id: 4, name: '陈师傅', gender: 2, avatar: '', shopName: '舒心按摩店', rating: 4.7, ratingCount: 67, orderCount: 189, distance: 3.8, price: 188, status: 1 },
    { id: 5, name: '刘师傅', gender: 1, avatar: '', shopName: '悦享SPA会所', rating: 4.8, ratingCount: 134, orderCount: 275, distance: 1.5, price: 238, status: 0 },
    { id: 6, name: '赵师傅', gender: 2, avatar: '', shopName: '康乐养生馆', rating: 4.6, ratingCount: 45, orderCount: 123, distance: 4.2, price: 178, status: 1 },
    { id: 7, name: '孙师傅', gender: 1, avatar: '', shopName: '舒心按摩店', rating: 4.9, ratingCount: 178, orderCount: 356, distance: 2.1, price: 258, status: 1 },
    { id: 8, name: '周师傅', gender: 2, avatar: '', shopName: '悦享SPA会所', rating: 4.5, ratingCount: 34, orderCount: 89, distance: 5.6, price: 168, status: 2 },
    { id: 9, name: '吴师傅', gender: 1, avatar: '', shopName: '康乐养生馆', rating: 4.7, ratingCount: 89, orderCount: 198, distance: 3.2, price: 208, status: 1 },
    { id: 10, name: '郑师傅', gender: 2, avatar: '', shopName: '舒心按摩店', rating: 4.8, ratingCount: 112, orderCount: 234, distance: 1.8, price: 218, status: 1 }
  ];

  // 筛选配置
  const filterConfigs = {
    gender: {
      title: '性别',
      options: [
        { label: '不限', value: '' },
        { label: '男技师', value: '1' },
        { label: '女技师', value: '2' }
      ]
    },
    rating: {
      title: '评分',
      options: [
        { label: '不限', value: '' },
        { label: '4.5分以上', value: '4.5' },
        { label: '4.7分以上', value: '4.7' },
        { label: '4.9分以上', value: '4.9' }
      ]
    },
    distance: {
      title: '距离',
      options: [
        { label: '不限', value: '' },
        { label: '3km以内', value: '3' },
        { label: '5km以内', value: '5' },
        { label: '10km以内', value: '10' }
      ]
    },
    sort: {
      title: '排序方式',
      options: [
        { label: '综合排序', value: '' },
        { label: '距离最近', value: 'distance_asc' },
        { label: '评分最高', value: 'rating_desc' },
        { label: '价格最低', value: 'price_asc' },
        { label: '价格最高', value: 'price_desc' }
      ]
    }
  };

  // 当前筛选状态
  let currentFilters = {
    gender: '',
    rating: '',
    distance: '',
    sort: ''
  };

  let activeFilterType = null;

  // 从 URL 参数获取初始筛选
  const params = QY.getParams();
  if (params.serviceId) {
    // 可以根据服务ID筛选技师
  }

  // 切换筛选面板
  window.toggleFilter = function(type) {
    const panel = document.getElementById('filterPanel');
    const filterItems = document.querySelectorAll('.filter-item');
    
    if (activeFilterType === type) {
      closeFilter();
      return;
    }

    activeFilterType = type;
    filterItems.forEach(item => {
      item.classList.toggle('active', item.id === `filter${type.charAt(0).toUpperCase() + type.slice(1)}`);
    });

    renderFilterPanel(type);
    panel.style.display = 'block';
  };

  // 关闭筛选面板
  window.closeFilter = function() {
    const panel = document.getElementById('filterPanel');
    const filterItems = document.querySelectorAll('.filter-item');
    
    activeFilterType = null;
    filterItems.forEach(item => item.classList.remove('active'));
    panel.style.display = 'none';
  };

  // 渲染筛选面板内容
  function renderFilterPanel(type) {
    const content = document.getElementById('filterPanelContent');
    const config = filterConfigs[type];
    
    content.innerHTML = `
      <div class="filter-title" style="font-size: 14px; font-weight: 500; margin-bottom: 12px;">${config.title}</div>
      <div class="filter-options">
        ${config.options.map(opt => `
          <div class="filter-option ${currentFilters[type] === opt.value ? 'active' : ''}" 
               onclick="selectFilter('${type}', '${opt.value}')">
            ${opt.label}
          </div>
        `).join('')}
      </div>
    `;
  }

  // 选择筛选项
  window.selectFilter = function(type, value) {
    currentFilters[type] = value;
    updateFilterLabel(type, value);
    closeFilter();
    renderTechnicianList();
  };

  // 更新筛选按钮文字
  function updateFilterLabel(type, value) {
    const filterItem = document.getElementById(`filter${type.charAt(0).toUpperCase() + type.slice(1)}`);
    const config = filterConfigs[type];
    const option = config.options.find(opt => opt.value === value);
    
    if (option && value) {
      filterItem.querySelector('span').textContent = option.label;
    } else {
      filterItem.querySelector('span').textContent = config.title.replace('方式', '');
    }
  }

  // 重置筛选
  window.resetFilters = function() {
    currentFilters = { gender: '', rating: '', distance: '', sort: '' };
    renderTechnicianList();
    
    // 重置筛选按钮文字
    document.querySelector('#filterGender span').textContent = '性别';
    document.querySelector('#filterRating span').textContent = '评分';
    document.querySelector('#filterDistance span').textContent = '距离';
    document.querySelector('#filterSort span').textContent = '综合排序';
  };


  // 筛选技师列表
  function filterTechnicians() {
    let filtered = [...allTechnicians];

    // 性别筛选
    if (currentFilters.gender) {
      const gender = parseInt(currentFilters.gender);
      filtered = filtered.filter(t => t.gender === gender);
    }

    // 评分筛选
    if (currentFilters.rating) {
      const minRating = parseFloat(currentFilters.rating);
      filtered = filtered.filter(t => t.rating >= minRating);
    }

    // 距离筛选
    if (currentFilters.distance) {
      const maxDistance = parseFloat(currentFilters.distance);
      filtered = filtered.filter(t => t.distance <= maxDistance);
    }

    // 排序
    switch (currentFilters.sort) {
      case 'distance_asc':
        filtered.sort((a, b) => a.distance - b.distance);
        break;
      case 'rating_desc':
        filtered.sort((a, b) => b.rating - a.rating);
        break;
      case 'price_asc':
        filtered.sort((a, b) => a.price - b.price);
        break;
      case 'price_desc':
        filtered.sort((a, b) => b.price - a.price);
        break;
      default:
        // 综合排序：默认按距离
        filtered.sort((a, b) => a.distance - b.distance);
    }

    return filtered;
  }

  // 获取状态文字
  function getStatusText(status) {
    switch (status) {
      case 1: return '在线';
      case 2: return '忙碌';
      default: return '离线';
    }
  }

  // 获取状态类名
  function getStatusClass(status) {
    switch (status) {
      case 1: return 'online';
      case 2: return 'busy';
      default: return 'offline';
    }
  }

  // 渲染技师列表
  function renderTechnicianList() {
    const list = document.getElementById('technicianList');
    const emptyState = document.getElementById('emptyState');
    const technicians = filterTechnicians();

    if (technicians.length === 0) {
      list.style.display = 'none';
      emptyState.style.display = 'flex';
      return;
    }

    list.style.display = 'block';
    emptyState.style.display = 'none';

    list.innerHTML = technicians.map(tech => `
      <div class="technician-card" onclick="QY.navigateTo('technician/detail', { id: ${tech.id} })">
        <div class="technician-avatar">
          ${tech.avatar}
          <span class="technician-status ${getStatusClass(tech.status)}"></span>
        </div>
        <div class="technician-info">
          <div class="technician-header">
            <span class="technician-name">${tech.name}</span>
            <span class="technician-gender ${tech.gender === 1 ? 'male' : 'female'}">
              ${tech.gender === 1 ? '♂' : '♀'}
            </span>
          </div>
          <div class="technician-shop">${tech.shopName}</div>
          <div class="technician-stats">
            <span class="technician-rating">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
              </svg>
              ${tech.rating}
            </span>
            <span class="technician-orders">已服务${tech.orderCount}单</span>
          </div>
          <div class="technician-footer">
            <span class="technician-distance">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
              </svg>
              ${tech.distance}km
            </span>
            <span class="technician-price">
              ${tech.price}
              <span class="technician-price-suffix">起</span>
            </span>
          </div>
        </div>
      </div>
    `).join('');
  }

  // 初始化
  renderTechnicianList();

})();
</script>
