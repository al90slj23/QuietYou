# 09.tool-01.gosh - go.sh 统一入口脚本规范

> **文档版本**：v1.0.0
> **创建日期**：2026-01-12
> **基于**：ZERO 框架规范

---

## 📍 文档定位

本文档定义轻养到家项目的 **go.sh 统一入口脚本**设计规范。

---

## 🎯 核心理念

### 为什么需要 go.sh

1. **统一入口**：一个命令搞定所有常用操作
2. **降低记忆成本**：不用记复杂命令，数字选择即可
3. **模块化扩展**：按需添加子脚本，主入口不变
4. **团队协作**：新成员快速上手

---

## 📁 文件结构

```
QuietYou/
├── go.sh          # 主入口（必需）
├── go.lib.sh      # 通用库（必需）
├── go.ai.sh       # AI 提交摘要
├── go.git.sh      # Git 操作
├── go.0.sh        # 选项 0: 本地开发
├── go.1.sh        # 选项 1: GitHub + 服务器部署
├── go.2.sh        # 选项 2: 仅 rsync 同步
├── go.3.sh        # 选项 3: 运行测试
└── go.4.sh        # 选项 4: 数据库操作
```

---

## 🔢 选项编号

| 编号 | 用途 | 说明 |
|------|------|------|
| 0 | 本地开发 | 启动开发服务器（默认选项） |
| 1 | GitHub + 服务器部署 | 构建 + Git + rsync |
| 2 | 仅 rsync 同步 | 快速同步到服务器 |
| 3 | 运行测试 | 执行测试用例 |
| 4 | 数据库操作 | 数据库管理 |

---

## 🚀 使用方式

### 交互式

```bash
./go.sh
# 显示菜单，等待用户选择
# 15秒无输入自动选择默认选项 0
```

### 直接执行

```bash
./go.sh 1    # 直接执行部署
./go.sh 2    # 直接执行 rsync 同步
```

### 管道输入

```bash
echo "1" | ./go.sh    # 自动选择选项 1
```

---

## 📝 子脚本模板

```bash
#!/bin/bash
# ================================================================
# 文件名: go.N.sh
# 中文名: 选项 N - 功能描述
# 创建时间: YYYY-MM-DD
# ================================================================
#
# 【文件职责】
# [描述这个脚本的主要功能]
#
# ================================================================

step "功能描述"

# ============================================================
# 阶段1: 第一步
# ============================================================
step "执行第一步..."
# 具体命令

# ============================================================
# 阶段2: 第二步
# ============================================================
step "执行第二步..."
# 具体命令

echo ""
success "操作完成"
```

---

## 🎨 输出规范

### 颜色定义

```bash
RED='\033[0;31m'      # 错误
GREEN='\033[0;32m'    # 成功
YELLOW='\033[1;33m'   # 警告
BLUE='\033[0;34m'     # 信息
CYAN='\033[1;36m'     # 步骤
NC='\033[0m'          # 重置
```

### 输出函数

```bash
success "操作成功"     # ✅ 绿色
error "操作失败"       # ❌ 红色
warn "警告信息"        # ⚠️  黄色
info "提示信息"        # ℹ️  蓝色
step "执行步骤"        # 📌 青色
```

---

## 🔧 通用函数（go.lib.sh）

### 环境检查

```bash
check_node    # 检查 Node.js
check_php     # 检查 PHP
load_env      # 加载 .env 环境变量
```

### 输出函数

```bash
success "message"
error "message"
warn "message"
info "message"
step "message"
```

---

## 📋 部署流程（go.1.sh）

```
1. 构建前端项目
   - apps/home → pages/home
   - apps/user → pages/user

2. 显示变更文件
   - git status --short

3. AI 生成提交摘要
   - 调用 go.ai.sh

4. Git 提交 + 推送
   - git add .
   - git commit
   - git push origin main

5. rsync 同步到服务器
   - 使用 .deployignore 排除规则

6. 服务器权限设置
   - chown -R www:www
   - chmod -R 755
```

---

## ✅ 检查清单

- [ ] go.sh 有执行权限 (`chmod +x go.sh`)
- [ ] go.lib.sh 包含颜色定义和工具函数
- [ ] 每个子脚本有文件头注释
- [ ] 菜单选项清晰易懂
- [ ] 有默认选项（超时自动选择）

---

**最后更新**：2026-01-12
