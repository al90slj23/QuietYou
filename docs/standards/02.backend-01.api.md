# 02.backend-01.api - API è®¾è®¡è§„èŒƒ

> **æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0.0
> **åˆ›å»ºæ—¥æœŸ**ï¼š2026-01-12
> **åŸºäº**ï¼šZERO æ¡†æ¶è§„èŒƒ

---

## ğŸ“ æ–‡æ¡£å®šä½

æœ¬æ–‡æ¡£å®šä¹‰è½»å…»åˆ°å®¶é¡¹ç›®çš„ **API è·¯ç”±è®¾è®¡è§„èŒƒ**ã€‚

---

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

### é“å¾‹ï¼šæ–œæ ä»…ç”¨äºçœŸå®ç›®å½•

```
æ–œæ  "/" å·¦å³å¿…é¡»æ˜¯çœŸå®å­˜åœ¨çš„ç›®å½•å±‚çº§
è™šæ‹Ÿå‚æ•°ï¼ˆIDã€æ“ä½œåï¼‰å¿…é¡»ç”¨å†’å· ":"
```

---

## ğŸ“ è¯­æ³•è§„åˆ™

### 1. æ–œæ  `/` - ä»…ç”¨äºçœŸå®ç›®å½•

```
âœ… /api/admin/users/list
   â†’ å¯¹åº”ç›®å½• api/admin/users/list/ å­˜åœ¨

âŒ /api/admin/users/list/123
   â†’ ç›®å½• api/admin/users/list/123/ ä¸å­˜åœ¨ï¼
```

### 2. å•å†’å· `:` - è™šæ‹Ÿå†…å®¹ï¼ˆIDæˆ–æ“ä½œï¼‰

```
# èµ„æºID
GET    /api/user/order/list:123       # è·å–è®¢å•ID=123
PUT    /api/user/order/list:123       # æ›´æ–°è®¢å•ID=123
DELETE /api/user/order/list:123       # åˆ é™¤è®¢å•ID=123

# è‡ªå®šä¹‰æ“ä½œ
GET    /api/admin/order/list:export   # å¯¼å‡º
POST   /api/admin/order/list:cancel   # å–æ¶ˆè®¢å•
```

### 3. åŒå†’å· `::` - å­èµ„æºå±‚çº§

```
# è·å–ç”¨æˆ·çš„è®¢å•åˆ—è¡¨
GET    /api/admin/user/list:123::orders

# è·å–ç”¨æˆ·çš„ç‰¹å®šè®¢å•
GET    /api/admin/user/list:123::orders:456
```

---

## ğŸ“¡ API è·¯ç”±ä¸¾ä¾‹

### ç”¨æˆ·ç«¯ API

```bash
# æœåŠ¡åˆ—è¡¨
GET    /api/user/service/list

# æœåŠ¡è¯¦æƒ…
GET    /api/user/service/detail:123

# æŠ€å¸ˆåˆ—è¡¨
GET    /api/user/technician/list

# åˆ›å»ºè®¢å•
POST   /api/user/order/create

# è®¢å•åˆ—è¡¨
GET    /api/user/order/list

# è®¢å•è¯¦æƒ…
GET    /api/user/order/detail:123
```

### ç®¡ç†åå° API

```bash
# ç”¨æˆ·ç®¡ç†
GET    /api/admin/user/list
POST   /api/admin/user/list
PUT    /api/admin/user/list:123
DELETE /api/admin/user/list:123

# è®¢å•ç®¡ç†
GET    /api/admin/order/list
GET    /api/admin/order/list:export
```

---

## ğŸ” PHP API è®¤è¯è§„èŒƒ

### æ–‡ä»¶åˆ†ç±»

| åç¼€ | ç”¨é€” | å¯ä»¥ require |
|------|------|-------------|
| `.include.php` | åº“æ–‡ä»¶ï¼ˆå‡½æ•°/ç±»å®šä¹‰ï¼‰ | âœ… å¯ä»¥ require |
| `.api.php` | API å…¥å£ï¼ˆè¾“å‡º JSONï¼‰ | âŒ ä¸è¦ require |

### API å…¥å£æ¨¡æ¿

```php
<?php
/**
 * ================================================================
 * æ–‡ä»¶å: list.api.php
 * åˆ›å»ºæ—¶é—´: 2026-01-12
 * ================================================================
 *
 * ã€æ–‡ä»¶èŒè´£ã€‘
 * ç”¨æˆ·è®¢å•åˆ—è¡¨ API
 *
 * ================================================================
 */

require_once __DIR__ . '/../../../../bootstrap.include.php';

header('Content-Type: application/json; charset=utf-8');

// è·å–è¾“å…¥
$input = json_decode(file_get_contents('php://input'), true);
$action = $input['action'] ?? 'list';

// è®¤è¯æ£€æŸ¥
$token = $input['token'] ?? '';
if (!checkUserSession($token)) {
    sendError(401, 'æœªæˆæƒ');
}

// å¤„ç†è¯·æ±‚
switch ($action) {
    case 'list':
        // è·å–åˆ—è¡¨
        break;
    default:
        sendError(400, 'æœªçŸ¥æ“ä½œ');
}
```

---

## ğŸ“‹ å“åº”æ ¼å¼

### æˆåŠŸå“åº”

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "list": [],
        "total": 100,
        "page": 1,
        "pageSize": 20
    }
}
```

### é”™è¯¯å“åº”

```json
{
    "code": 401,
    "message": "æœªæˆæƒ",
    "data": null
}
```

### é”™è¯¯ç å®šä¹‰

| é”™è¯¯ç  | è¯´æ˜ |
|--------|------|
| 0 | æˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | æœªæˆæƒ |
| 403 | ç¦æ­¢è®¿é—® |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 500 | æœåŠ¡å™¨é”™è¯¯ |

---

**æœ€åæ›´æ–°**ï¼š2026-01-12
